<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ryan Games 3.0 - Arquivo √önico</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        /* --- ESTILOS GLOBAIS --- */
        :root {
            --primary-color: #6a11cb;
            --secondary-color: #2575fc;
            --bg-dark: #121212;
            --bg-light: #f0f0f0;
            --text-light: #e0e0e0;
            --text-dark: #333;
            --game-info-color: #ffcc00;
        }

        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            color: var(--text-light);
            background-color: var(--bg-dark);
            /* Imagem de fundo assumida: voc√™ deve ter uma imagem local chamada 'fb42c0.png' ou URL */
            /* Se a imagem de fundo n√£o carregar, use background-color: var(--bg-dark); */
            background-image: url("https://i.imgur.com/fb42c0.png"); 
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
            transition: background-color 0.3s, color 0.3s;
        }

        /* --- MODO CLARO --- */
        body.light-mode {
            background-color: var(--bg-light);
            color: var(--text-dark);
        }

        body.light-mode header,
        body.light-mode .section-container {
            background-color: rgba(255, 255, 255, 0.95);
            color: var(--text-dark);
        }

        body.light-mode .nav-links a {
             color: var(--text-dark);
        }

        body.light-mode #leaderboard-container {
            background-color: rgba(255, 255, 255, 0.2);
            box-shadow: inset 0 0 10px rgba(106, 17, 203, 0.5);
        }
        /* --- FIM MODO CLARO --- */


        /* --- HEADER E NAVEGA√á√ÉO --- */
        header {
            width: 100%;
            background-color: rgba(18, 18, 18, 0.95);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        nav {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
        }

        .logo {
            font-family: 'Press Start 2P', cursive;
            font-size: 1.5em;
            color: var(--secondary-color);
            text-shadow: 0 0 5px var(--primary-color);
        }

        .nav-controls {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        #settings-button {
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 1.5em;
            cursor: pointer;
            transition: transform 0.3s;
        }

        #settings-button:hover {
            transform: rotate(90deg);
            color: var(--game-info-color);
        }

        .nav-links a {
            color: var(--text-light);
            text-decoration: none;
            margin-left: 25px;
            font-weight: 700;
            transition: color 0.3s ease, text-shadow 0.3s ease;
            padding: 5px 0;
            display: inline-block;
        }

        .nav-links a:hover {
            color: var(--game-info-color);
            text-shadow: 0 0 8px var(--game-info-color);
        }

        /* --- MENU HAMBURGER E RESPONSIVIDADE --- */
        .hamburger {
            display: none;
            cursor: pointer;
            padding: 5px;
        }
        
        .hamburger div {
            width: 25px;
            height: 3px;
            background-color: var(--text-light);
            margin: 5px;
            transition: all 0.3s ease;
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
                flex-direction: column;
                position: absolute;
                top: 70px; /* Ajuste conforme a altura do seu header */
                left: 0;
                width: 100%;
                background-color: rgba(18, 18, 18, 0.95);
                padding: 10px 0;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            }
            .nav-links.active {
                display: flex;
            }
            .nav-links a {
                margin: 10px 0;
                padding: 10px 30px;
                text-align: center;
            }
            .hamburger {
                display: block;
            }
        }
        /* --- FIM MENU HAMBURGER --- */

        /* --- CONTE√öDO PRINCIPAL (MAIN) --- */
        main {
            width: 100%;
            max-width: 1200px;
            padding: 40px 20px;
        }

        .section-container {
            margin-bottom: 80px;
            padding: 40px;
            background-color: rgba(25, 25, 25, 0.9);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7);
            animation: fadeIn 1s ease-out;
            transition: background-color 0.3s;
        }

        body.light-mode .section-container {
            background-color: rgba(240, 240, 240, 0.9);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h2 {
            font-family: 'Press Start 2P', cursive;
            font-size: 2.2em;
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 40px;
            text-shadow: 2px 2px 0 var(--secondary-color);
        }

        /* --- SE√á√ÉO DE LINKS --- */
        #game-links .links-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .link-item {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            padding: 20px;
            border-radius: 10px;
            text-decoration: none;
            color: #ffffff;
            font-size: 1.2em;
            font-weight: 700;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            border: 3px solid transparent;
            text-align: left;
            letter-spacing: 1px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
        }

        .link-item:hover {
            background: linear-gradient(135deg, var(--secondary-color) 0%, var(--primary-color) 100%);
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.6);
            border-color: var(--game-info-color);
        }

        .link-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .link-counter {
            background-color: rgba(0, 0, 0, 0.3);
            color: var(--game-info-color);
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.9em;
            font-family: 'Press Start 2P', cursive;
        }

        .favorite-btn {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: rgba(255, 255, 255, 0.5);
            transition: color 0.2s;
        }

        .favorite-btn.active {
            color: #ffcc00;
        }

        /* --- SE√á√ÉO DO JOGO & LEADERBOARD --- */
        #game-wrapper {
            display: flex;
            gap: 20px;
            width: 100%;
            justify-content: center;
            flex-wrap: wrap;
        }

        #dog-game-controls {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            max-width: 600px;
        }

        #leaderboard-container {
            width: 300px;
            min-height: 400px;
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            border: 1px solid var(--secondary-color);
            box-shadow: inset 0 0 10px rgba(37, 117, 252, 0.5);
        }

        #leaderboard-container h3 {
            font-family: 'Press Start 2P', cursive;
            color: var(--game-info-color);
            font-size: 1.2em;
            margin-top: 0;
            text-align: center;
        }

        #leaderboard table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9em;
        }

        #leaderboard th, #leaderboard td {
            padding: 8px 0;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        #leaderboard th {
            color: var(--primary-color);
            font-weight: bold;
        }

        #leaderboard tr:nth-child(1) td { color: gold; font-weight: bold; }
        #leaderboard tr:nth-child(2) td { color: silver; }
        #leaderboard tr:nth-child(3) td { color: #cd7f32; }

        /* --- Media Queries para Responsividade --- */
        @media (max-width: 960px) {
            #game-wrapper {
                flex-direction: column;
                align-items: center;
            }
            #leaderboard-container {
                width: 100%;
                max-width: 600px;
                margin-top: 20px;
            }
        }
        
        @media (max-width: 768px) {
            .grid-sections {
                grid-template-columns: 1fr;
            }
        }

        /* --- SE√á√ïES DE CONQUISTAS E NEWS --- */
        .grid-sections {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
        }

        /* Conquistas */
        .achievement-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            background-color: rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s;
        }

        .achievement-item.unlocked {
            background-color: rgba(0, 255, 0, 0.1);
            border-left: 5px solid limegreen;
        }

        .achievement-icon {
            font-size: 2em;
        }

        .achievement-info {
            flex-grow: 1;
        }

        .achievement-title {
            font-weight: bold;
            color: var(--game-info-color);
        }

        .achievement-description {
            font-size: 0.9em;
            color: var(--text-light);
        }

        /* Not√≠cias */
        .news-item {
            border-left: 3px solid var(--secondary-color);
            padding-left: 15px;
            margin-bottom: 20px;
        }

        .news-item h4 {
            margin: 0;
            color: var(--primary-color);
        }

        .news-item small {
            display: block;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 5px;
        }

        /* --- TOAST NOTIFICATIONS --- */
        #toast-container {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 3000;
        }

        .toast {
            background-color: rgba(106, 17, 203, 0.95);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            margin-bottom: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            opacity: 0;
            transition: opacity 0.5s, transform 0.5s;
            transform: translateX(100%);
            max-width: 300px;
            font-size: 0.9em;
        }

        .toast.show {
            opacity: 1;
            transform: translateX(0);
        }

        /* --- Estilos do Jogo (Mantidos) --- */
        #game-info {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        #score, #high-score, #lives {
            font-family: 'Press Start 2P', cursive;
            font-size: 1.2em;
            color: var(--game-info-color);
            text-shadow: 1px 1px 3px #000;
            margin: 5px 15px;
        }

        #dog-canvas {
            border: 5px solid var(--primary-color);
            background-color: #0d0d0d;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(106, 17, 203, 0.7);
            display: none;
            width: 600px;
            height: 600px;
            max-width: 100%;
            max-height: 100%;
        }

        .game-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        .game-button {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            font-weight: 700;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .game-button:hover {
            background: linear-gradient(135deg, var(--secondary-color) 0%, var(--primary-color) 100%);
            transform: scale(1.05);
        }

        #start-screen, #game-over-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 20px;
            z-index: 50;
        }

        #game-over-screen {
            display: none;
        }

        #legendary-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3em;
            color: white;
            text-shadow: 0 0 10px #ff00ff, 0 0 20px #00ffff;
            animation: pulse 1s infinite alternate;
            z-index: 200;
            display: none;
        }

        @keyframes pulse {
            from { opacity: 0.7; transform: translate(-50%, -50%) scale(1); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
        }
        /* --- PAINEL DE CONFIGURA√á√ïES (MODAL) --- */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.7);
            padding-top: 60px;
        }

        .modal-content {
            background-color: rgba(25, 25, 25, 0.95);
            margin: 5% auto;
            padding: 20px;
            border: 3px solid var(--primary-color);
            width: 80%;
            max-width: 500px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.9);
            position: relative;
        }

        .close-button {
            color: var(--text-light);
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close-button:hover,
        .close-button:focus {
            color: var(--game-info-color);
            text-decoration: none;
            cursor: pointer;
        }

        .config-item {
            padding: 15px 0;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .config-item:last-child {
            border-bottom: none;
        }

        .config-item button, .config-item select {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-weight: bold;
        }

        .config-item button:hover {
            background-color: var(--primary-color);
        }
        /* --- FOOTER --- */
        footer {
            width: 100%;
            text-align: center;
            padding: 20px;
            background-color: var(--bg-dark);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 50px;
            transition: background-color 0.3s;
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="logo">RYAN GAMES</div>
            <div class="nav-links">
                <a href="#dog-game" data-key="nav_game">JOGO DO CACHORRINHO</a>
                <a href="#game-links" data-key="nav_games">OUTROS JOGOS</a>
                <a href="#achievements-section" data-key="nav_achievements">CONQUISTAS</a>
                <a href="#news-section" data-key="nav_news">O QUE H√Å DE NOVO</a>
                <a href="#about" data-key="nav_about">SOBRE</a>
            </div>
            <div class="nav-controls">
                <button id="settings-button" title="Configura√ß√µes">‚öôÔ∏è</button>
                <div class="hamburger" onclick="toggleMenu()">
                    <div class="line1"></div>
                    <div class="line2"></div>
                    <div class="line3"></div>
                </div>
            </div>
        </nav>
    </header>

    <main>

        <section id="dog-game" class="section-container">
            <h2 data-key="title_dog_game">üê∂ Jogo do Cachorrinho: Sobreviv√™ncia ü¶¥</h2>
            <div id="game-wrapper">
                <div id="dog-game-controls">
                    <div id="game-info">
                        <div id="score" data-key="score">Pontos: 0</div>
                        <div id="high-score" data-key="high_score">Recorde: 0</div>
                        <div id="lives" data-key="lives">Vidas: 3</div>
                    </div>

                    <canvas id="dog-canvas" width="600" height="600"></canvas>

                    <div id="start-screen">
                        <h3 style="font-family: 'Press Start 2P', cursive; color: var(--game-info-color);" data-key="welcome">Bem-vindo!</h3>
                        <p data-key="controls_tip">Use as setas para mover e **X** para atirar o osso.</p>
                        <div class="game-buttons">
                            <button id="start-button" class="game-button" data-key="start_game">INICIAR JOGO</button>
                            <button id="fullscreen-button" class="game-button" data-key="fullscreen">TELA CHEIA</button>
                        </div>
                    </div>

                    <div id="game-over-screen">
                        <h3 style="font-family: 'Press Start 2P', cursive;" data-key="game_over">FIM DE JOGO</h3>
                        <p><span data-key="final_score_msg">Sua pontua√ß√£o final √©:</span> <span id="final-score" style="color: var(--game-info-color);">0</span></p>
                        <p id="new-high-score-message" style="color: #ffcc00; display: none;" data-key="new_record">NOVO RECORDE!</p>
                        <input type="text" id="player-name-input" maxlength="3" placeholder="Nome (3 letras)" style="padding: 8px; margin-bottom: 15px; text-align: center; text-transform: uppercase;">
                        <button id="restart-button" class="game-button" data-key="play_again">JOGAR NOVAMENTE</button>
                    </div>

                    <div id="legendary-message" style="display: none;" data-key="legendary_power">O PODER LEND√ÅRIO APARECEU!!!</div>
                </div>

                <div id="leaderboard-container">
                    <h3 data-key="leaderboard_title">üèÜ LEADERBOARD</h3>
                    <div id="leaderboard">
                        <table>
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th data-key="table_name">Nome</th>
                                    <th data-key="table_score">Pontos</th>
                                </tr>
                            </thead>
                            <tbody id="leaderboard-body">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <hr>

        <section id="game-links" class="section-container">
            <h2 data-key="title_games">üïπÔ∏è Outros Jogos</h2>
            <h3 data-key="favorites_title">‚≠ê Meus Favoritos</h3>
            <div class="links-grid" id="favorites-grid-container">
                <p id="no-favorites" data-key="no_favorites">Nenhum favorito selecionado. Clique na estrela ‚≠ê para adicionar!</p>
            </div>
            <br>
            <h3 data-key="all_games_title">Todos os Jogos</h3>
            <div class="links-grid" id="links-grid-container">
            </div>
        </section>

        <hr>

        <section id="achievements-section" class="section-container">
            <h2 data-key="title_achievements">üèÖ Conquistas</h2>
            <div id="achievements-list">
            </div>
        </section>

        <hr>

        <section id="news-section" class="section-container">
            <h2 data-key="title_news">üì∞ O Que H√° de Novo?</h2>
            <div id="news-list">
            </div>
        </section>

        <hr>

        <section id="about" class="section-container">
            <h2 data-key="title_about">üìú Sobre o Projeto Ryan Games 3.0</h2>
            <p data-key="about_p1" style="font-size: 1.1em; line-height: 1.6;">
                Este portal foi criado para reunir uma cole√ß√£o de jogos, desde prot√≥tipos em desenvolvimento (como o Jogo do Cachorrinho) at√© links de jogos favoritos. A vers√£o 3.0 foca em uma experi√™ncia de usu√°rio mais limpa, moderna e otimizada para todas as telas. O Jogo do Cachorrinho √© um projeto em **constante evolu√ß√£o**, sendo um playground para novas mec√¢nicas de jogo.
            </p>
            <p data-key="about_p2" style="text-align: right; margin-top: 20px; font-weight: bold; color: var(--secondary-color);">
                Desenvolvido por Ryan.
            </p>
        </section>
    </main>

    <footer>
        <p data-key="footer_text">&copy; 2025 Ryan Games 3.0 - Todos os direitos reservados. Projeto em desenvolvimento.</p>
    </footer>

    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="close-settings-modal">&times;</span>
            <h2 data-key="settings_title">‚öôÔ∏è Configura√ß√µes do Site</h2>

            <div class="config-item">
                <span data-key="config_language">Idioma:</span>
                <select id="language-selector">
                    <option value="pt-br">Portugu√™s (BR)</option>
                    <option value="en">English (US)</option>
                </select>
            </div>

            <div class="config-item">
                <span data-key="config_theme">Tema Visual:</span>
                <button id="toggle-theme" data-key="config_toggle_theme">Alternar Tema</button>
            </div>

            <div class="config-item">
                <span data-key="config_reset_achievements">Resetar Conquistas:</span>
                <button id="reset-achievements-btn" data-key="config_reset">Resetar</button>
            </div>

            <div class="config-item">
                <span data-key="config_reset_data">Limpar TODOS os Dados Locais (Recordes/Cliques):</span>
                <button id="clear-local-data-btn" data-key="config_clear_all">Limpar Tudo</button>
            </div>
        </div>
    </div>

    <div id="toast-container"></div>

    <script>
        // ====================================================================
        // --- CONFIGURA√á√ïES GERAIS E DADOS (Global) ---
        // ====================================================================

        const currentLang = localStorage.getItem('language') || 'pt-br';
        const currentTheme = localStorage.getItem('theme') || 'dark';

        // OBJETO DE TRADU√á√ÉO
        const translations = {
            'pt-br': {
                'nav_game': 'JOGO DO CACHORRINHO', 'nav_games': 'OUTROS JOGOS', 'nav_achievements': 'CONQUISTAS', 'nav_news': 'O QUE H√Å DE NOVO', 'nav_about': 'SOBRE',
                'title_dog_game': 'üê∂ Jogo do Cachorrinho: Sobreviv√™ncia ü¶¥',
                'score': 'Pontos: 0', 'high_score': 'Recorde: 0', 'lives': 'Vidas: 3',
                'welcome': 'Bem-vindo!', 'controls_tip': 'Use as setas para mover e **X** para atirar o osso.',
                'start_game': 'INICIAR JOGO', 'fullscreen': 'TELA CHEIA', 'game_over': 'FIM DE JOGO',
                'final_score_msg': 'Sua pontua√ß√£o final √©:', 'new_record': 'NOVO RECORDE!',
                'play_again': 'JOGAR NOVAMENTE', 'legendary_power': 'O PODER LEND√ÅRIO APARECEU!!!',
                'leaderboard_title': 'üèÜ LEADERBOARD', 'table_name': 'Nome', 'table_score': 'Pontos',
                'title_games': 'üïπÔ∏è Outros Jogos', 'favorites_title': '‚≠ê Meus Favoritos', 'all_games_title': 'Todos os Jogos',
                'no_favorites': 'Nenhum favorito selecionado. Clique na estrela ‚≠ê para adicionar!',
                'title_achievements': 'üèÖ Conquistas', 'title_news': 'üì∞ O Que H√° de Novo?',
                'title_about': 'üìú Sobre o Projeto Ryan Games 3.0',
                'about_p1': 'Este portal foi criado para reunir uma cole√ß√£o de jogos, desde prot√≥tipos em desenvolvimento (como o Jogo do Cachorrinho) at√© links de jogos favoritos. A vers√£o 3.0 foca em uma experi√™ncia de usu√°rio mais limpa, moderna e otimizada para todas as telas. O Jogo do Cachorrinho √© um projeto em **constante evolu√ß√£o**, sendo um playground para novas mec√¢nicas de jogo.',
                'about_p2': 'Desenvolvido por Ryan.',
                'footer_text': '&copy; 2025 Ryan Games 3.0 - Todos os direitos reservados. Projeto em desenvolvimento.',
                'settings_title': '‚öôÔ∏è Configura√ß√µes do Site', 'config_language': 'Idioma:', 'config_theme': 'Tema Visual:',
                'config_toggle_theme': 'Alternar Tema', 'config_reset_achievements': 'Resetar Conquistas:',
                'config_reset': 'Resetar', 'config_reset_data': 'Limpar TODOS os Dados Locais (Recordes/Cliques):',
                'config_clear_all': 'Limpar Tudo',
                // Conquistas
                'ach_unlocked': 'Conquista Desbloqueada',
                'ach_welcome_title': 'Bem-vindo(a)!', 'ach_welcome_desc': 'Abra o site pela primeira vez.',
                'ach_first_game_title': 'Primeiro Clique', 'ach_first_game_desc': 'Clique em qualquer link da se√ß√£o "Outros Jogos".',
                'ach_veteran_title': 'Veterano de Ryan', 'ach_veteran_desc': 'Alcance o N√≠vel 3 no Jogo do Cachorrinho.',
                'ach_master_title': 'Mestre da Sobreviv√™ncia', 'ach_master_desc': 'Alcance o N√≠vel 5 no Jogo do Cachorrinho.',
                // Notifica√ß√µes
                'notif_new_record': 'üéâ NOVO RECORDE! Seu nome foi adicionado ao Leaderboard.',
                'notif_cleared_data': 'üóëÔ∏è Todos os dados (recordes, cliques, conquistas) foram apagados.',
                'notif_theme_dark': '‚ö´ Modo Escuro ativado.', 'notif_theme_light': '‚ö™ Modo Claro ativado.',
                'notif_reset_achievements': 'üèÖ Conquistas resetadas com sucesso!',
                'no_records': 'Sem recordes ainda.'
            },
            'en': {
                'nav_game': 'DOGGY GAME', 'nav_games': 'OTHER GAMES', 'nav_achievements': 'ACHIEVEMENTS', 'nav_news': 'WHAT\'S NEW', 'nav_about': 'ABOUT',
                'title_dog_game': 'üê∂ Doggy Game: Survival ü¶¥',
                'score': 'Score: 0', 'high_score': 'High Score: 0', 'lives': 'Lives: 3',
                'welcome': 'Welcome!', 'controls_tip': 'Use the arrow keys to move and **X** to shoot the bone.',
                'start_game': 'START GAME', 'fullscreen': 'FULLSCREEN', 'game_over': 'GAME OVER',
                'final_score_msg': 'Your final score is:', 'new_record': 'NEW RECORD!',
                'play_again': 'PLAY AGAIN', 'legendary_power': 'LEGENDARY POWER APPEARED!!!',
                'leaderboard_title': 'üèÜ LEADERBOARD', 'table_name': 'Name', 'table_score': 'Score',
                'title_games': 'üïπÔ∏è Other Games', 'favorites_title': '‚≠ê My Favorites', 'all_games_title': 'All Games',
                'no_favorites': 'No favorites selected. Click the star ‚≠ê to add one!',
                'title_achievements': 'üèÖ Achievements', 'title_news': 'üì∞ What\'s New?',
                'title_about': 'üìú About the Ryan Games 3.0 Project',
                'about_p1': 'This portal was created to gather a collection of games, from prototypes in development (like the Doggy Game) to favorite game links. Version 3.0 focuses on a cleaner, more modern, and optimized user experience for all screens. The Doggy Game is a project in **constant evolution**, serving as a playground for new game mechanics.',
                'about_p2': 'Developed by Ryan.',
                'footer_text': '&copy; 2025 Ryan Games 3.0 - All rights reserved. Project in development.',
                'settings_title': '‚öôÔ∏è Site Settings', 'config_language': 'Language:', 'config_theme': 'Visual Theme:',
                'config_toggle_theme': 'Toggle Theme', 'config_reset_achievements': 'Reset Achievements:',
                'config_reset': 'Reset', 'config_reset_data': 'Clear ALL Local Data (High Scores/Clicks):',
                'config_clear_all': 'Clear All',
                // Conquistas
                'ach_unlocked': 'Achievement Unlocked',
                'ach_welcome_title': 'Welcome!', 'ach_welcome_desc': 'Open the site for the first time.',
                'ach_first_game_title': 'First Click', 'ach_first_game_desc': 'Click any link in the "Other Games" section.',
                'ach_veteran_title': 'Ryan Veteran', 'ach_veteran_desc': 'Reach Level 3 in the Doggy Game.',
                'ach_master_title': 'Survival Master', 'ach_master_desc': 'Reach Level 5 in the Doggy Game.',
                // Notifica√ß√µes
                'notif_new_record': 'üéâ NEW HIGH SCORE! Your name was added to the Leaderboard.',
                'notif_cleared_data': 'üóëÔ∏è All local data (scores, clicks, achievements) has been cleared.',
                'notif_theme_dark': '‚ö´ Dark Mode activated.', 'notif_theme_light': '‚ö™ Light Mode activated.',
                'notif_reset_achievements': 'üèÖ Achievements successfully reset!',
                'no_records': 'No high scores yet.'
            }
        };

        // ====================================================================
        // --- FUN√á√ïES GERAIS E DE NAVEGA√á√ÉO ---
        // ====================================================================

        function translatePage(lang) {
            document.querySelectorAll('[data-key]').forEach(element => {
                const key = element.getAttribute('data-key');
                if (translations[lang] && translations[lang][key]) {
                    if (element.tagName === 'BUTTON' || element.tagName === 'A' || element.tagName === 'SPAN') {
                        element.textContent = translations[lang][key];
                    } else if (element.tagName === 'P' && element.id !== 'no-favorites') {
                         // Permite formata√ß√£o bold para par√°grafos
                         let text = translations[lang][key];
                         text = text.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>');
                         element.innerHTML = text;
                    } else {
                        element.innerHTML = translations[lang][key];
                    }
                }
            });
            const playerNameInput = document.getElementById('player-name-input');
            if (playerNameInput) {
                playerNameInput.placeholder = lang === 'pt-br' ? 'Nome (3 letras)' : 'Name (3 letters)';
            }

            // Recarrega o conte√∫do din√¢mico traduzido
            loadGameLinks();
            renderAchievements();
            renderNews();
            renderLeaderboard();
        }

        // Tema Visual
        function applyTheme(theme) {
            if (theme === 'light') {
                document.body.classList.add('light-mode');
            } else {
                document.body.classList.remove('light-mode');
            }
            localStorage.setItem('theme', theme);
        }

        // Toast Notifications
        function showToast(message, type = 'info', duration = 4000) {
            const container = document.getElementById('toast-container');
            if (!container) return;

            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;

            container.appendChild(toast);

            // For√ßa o reflow para garantir a anima√ß√£o
            void toast.offsetWidth;

            toast.classList.add('show');

            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    container.removeChild(toast);
                }, 500); // Tempo para o CSS de transi√ß√£o
            }, duration);
        }
        
        // Hamburguer Menu Toggle
        function toggleMenu() {
            const navLinks = document.querySelector('.nav-links');
            navLinks.classList.toggle('active');
        }

        // ====================================================================
        // --- SE√á√ÉO DE LINKS (Outros Jogos) ---
        // ====================================================================

        const GAME_LINKS_DATA = [
            { id: 1, name: 'Google T-Rex Run', url: 'chrome://dino', icon: 'ü¶ñ' },
            { id: 2, name: 'Classic Snake', url: 'https://patorjk.com/games/snake/', icon: 'üêç' },
            { id: 3, name: 'Pac-Man', url: 'https://pacman.cc/', icon: 'üü°' },
            { id: 4, name: 'Lichess (Xadrez)', url: 'https://lichess.org/', icon: '‚ôüÔ∏è' },
            { id: 5, name: 'Web Dev Game', url: 'https://developerextraordinaire.com/game/web-dev-game', icon: 'üíª' }
        ];

        function getLinkData() {
            return JSON.parse(localStorage.getItem('gameLinkData')) || GAME_LINKS_DATA.map(link => ({
                id: link.id,
                name: link.name,
                url: link.url,
                icon: link.icon,
                clicks: 0,
                isFavorite: false
            }));
        }

        function saveLinkData(data) {
            localStorage.setItem('gameLinkData', JSON.stringify(data));
        }

        function handleLinkClick(id) {
            let data = getLinkData();
            const link = data.find(l => l.id === id);
            if (link) {
                link.clicks = (link.clicks || 0) + 1;
                saveLinkData(data);
                loadGameLinks(); // Recarrega a lista para atualizar a contagem
                checkAchievement('firstClick'); // Verifica a conquista de primeiro clique
            }
        }

        function toggleFavorite(id) {
            let data = getLinkData();
            const link = data.find(l => l.id === id);
            if (link) {
                link.isFavorite = !link.isFavorite;
                saveLinkData(data);
                loadGameLinks(); // Recarrega a lista para refletir a mudan√ßa
            }
        }

        function createLinkElement(link) {
            const currentData = getLinkData().find(l => l.id === link.id);
            const isFavorite = currentData ? currentData.isFavorite : false;
            const clicks = currentData ? currentData.clicks : 0;

            const linkItem = document.createElement('a');
            linkItem.href = link.url;
            linkItem.target = "_blank";
            linkItem.className = 'link-item';
            linkItem.onclick = () => handleLinkClick(link.id);

            const linkName = document.createElement('span');
            linkName.textContent = `${link.icon} ${link.name}`;
            linkItem.appendChild(linkName);

            const controls = document.createElement('div');
            controls.className = 'link-controls';

            const counter = document.createElement('span');
            counter.className = 'link-counter';
            counter.textContent = clicks;
            controls.appendChild(counter);

            const favButton = document.createElement('button');
            favButton.className = `favorite-btn ${isFavorite ? 'active' : ''}`;
            favButton.innerHTML = isFavorite ? '‚òÖ' : '‚òÜ';
            favButton.title = isFavorite ? 'Remover dos Favoritos' : 'Adicionar aos Favoritos';
            favButton.onclick = (e) => {
                e.preventDefault(); // Impede a navega√ß√£o ao clicar na estrela
                e.stopPropagation(); // Impede o clique de se propagar para o link pai
                toggleFavorite(link.id);
            };
            controls.appendChild(favButton);

            linkItem.appendChild(controls);
            return linkItem;
        }

        function loadGameLinks() {
            const allContainer = document.getElementById('links-grid-container');
            const favContainer = document.getElementById('favorites-grid-container');
            const noFavorites = document.getElementById('no-favorites');
            
            allContainer.innerHTML = '';
            favContainer.innerHTML = '';
            
            let data = getLinkData();

            // 1. Carregar Todos
            data.forEach(link => {
                allContainer.appendChild(createLinkElement(link));
            });

            // 2. Carregar Favoritos
            const favorites = data.filter(link => link.isFavorite);
            if (favorites.length > 0) {
                favorites.forEach(link => {
                    favContainer.appendChild(createLinkElement(link));
                });
                noFavorites.style.display = 'none';
            } else {
                 // Usa o elemento <p> existente para a mensagem
                favContainer.appendChild(noFavorites); 
                noFavorites.style.display = 'block';
            }
        }

        // ====================================================================
        // --- SE√á√ÉO DE CONQUISTAS ---
        // ====================================================================

        const ACHIEVEMENTS = {
            welcome: { id: 'welcome', icon: 'üëã', titleKey: 'ach_welcome_title', descKey: 'ach_welcome_desc', level: 1 },
            firstClick: { id: 'firstClick', icon: 'üñ±Ô∏è', titleKey: 'ach_first_game_title', descKey: 'ach_first_game_desc', level: 1 },
            veteran: { id: 'veteran', icon: 'üéñÔ∏è', titleKey: 'ach_veteran_title', descKey: 'ach_veteran_desc', level: 3 },
            master: { id: 'master', icon: 'üëë', titleKey: 'ach_master_title', descKey: 'ach_master_desc', level: 5 }
        };
        
        function getAchievements() {
            return JSON.parse(localStorage.getItem('achievements')) || {};
        }

        function setAchievement(id) {
            let achievements = getAchievements();
            if (!achievements[id]) {
                achievements[id] = true;
                localStorage.setItem('achievements', JSON.stringify(achievements));
                renderAchievements(); // Atualiza a visualiza√ß√£o
                const achievement = ACHIEVEMENTS[id];
                if (achievement) {
                    showToast(`${achievement.icon} ${getTranslation('ach_unlocked')}! ${getTranslation(achievement.titleKey)}`, 'success');
                }
            }
        }

        function checkAchievement(id, value) {
            switch (id) {
                case 'welcome':
                    setAchievement('welcome');
                    break;
                case 'firstClick':
                    setAchievement('firstClick');
                    break;
                case 'dogLevel':
                    if (value >= ACHIEVEMENTS.veteran.level) setAchievement('veteran');
                    if (value >= ACHIEVEMENTS.master.level) setAchievement('master');
                    break;
            }
        }

        function renderAchievements() {
            const container = document.getElementById('achievements-list');
            container.innerHTML = '';
            const unlocked = getAchievements();
            const lang = localStorage.getItem('language') || 'pt-br';

            Object.values(ACHIEVEMENTS).forEach(ach => {
                const isUnlocked = unlocked[ach.id];
                const item = document.createElement('div');
                item.className = `achievement-item ${isUnlocked ? 'unlocked' : ''}`;

                const icon = document.createElement('span');
                icon.className = 'achievement-icon';
                icon.textContent = isUnlocked ? ach.icon : 'üîí';
                
                const info = document.createElement('div');
                info.className = 'achievement-info';

                const title = document.createElement('div');
                title.className = 'achievement-title';
                title.textContent = translations[lang][ach.titleKey] || ach.titleKey;

                const desc = document.createElement('div');
                desc.className = 'achievement-description';
                desc.textContent = translations[lang][ach.descKey] || ach.descKey;
                
                info.appendChild(title);
                info.appendChild(desc);

                item.appendChild(icon);
                item.appendChild(info);
                container.appendChild(item);
            });
        }
        
        // ====================================================================
        // --- SE√á√ÉO DE NEWS ---
        // ====================================================================

        const NEWS_DATA = [
            { id: 1, date: '19/11/2025', title_pt: 'Lan√ßamento V3.0!', title_en: 'V3.0 Launch!', content_pt: 'Novo design do portal, modal de configura√ß√µes e sistema de conquistas implementados. O Jogo do Cachorrinho agora tem Leaderboard!', content_en: 'New portal design, settings modal, and achievement system implemented. The Doggy Game now has a Leaderboard!' },
            { id: 2, date: '01/10/2025', title_pt: 'Atualiza√ß√£o do Jogo', title_en: 'Game Update', content_pt: 'Adicionado Power-up de Invencibilidade (Arco-√≠ris) e novos inimigos mais r√°pidos.', content_en: 'Added Invincibility Power-up (Rainbow) and new faster enemies.' },
            { id: 3, date: '15/09/2025', title_pt: 'Links de Jogos', title_en: 'Game Links', content_pt: 'A se√ß√£o "Outros Jogos" foi reformulada com contagem de cliques e favoritos.', content_en: 'The "Other Games" section has been revamped with click count and favorites.' }
        ];

        function renderNews() {
            const container = document.getElementById('news-list');
            container.innerHTML = '';
            const lang = localStorage.getItem('language') || 'pt-br';

            NEWS_DATA.sort((a, b) => new Date(b.date.split('/').reverse().join('-')) - new Date(a.date.split('/').reverse().join('-')));

            NEWS_DATA.forEach(item => {
                const newsItem = document.createElement('div');
                newsItem.className = 'news-item';

                const title = document.createElement('h4');
                title.textContent = lang === 'pt-br' ? item.title_pt : item.title_en;

                const date = document.createElement('small');
                date.textContent = item.date;

                const content = document.createElement('p');
                content.textContent = lang === 'pt-br' ? item.content_pt : item.content_en;

                newsItem.appendChild(title);
                newsItem.appendChild(date);
                newsItem.appendChild(content);
                container.appendChild(newsItem);
            });
        }
        
        // ====================================================================
        // --- JOGO DO CACHORRINHO (Corre√ß√µes e L√≥gica) ---
        // ====================================================================
        
        // Elementos DOM do Jogo
        const gameCanvas = document.getElementById('dog-canvas');
        const gameCtx = gameCanvas.getContext('2d');
        const startScreen = document.getElementById('start-screen');
        const gameOverScreen = document.getElementById('game-over-screen');
        const startButton = document.getElementById('start-button');
        const restartButton = document.getElementById('restart-button');
        const scoreDisplay = document.getElementById('score');
        const highScoreDisplay = document.getElementById('high-score');
        const livesDisplay = document.getElementById('lives');
        const finalScoreDisplay = document.getElementById('final-score');
        const newHighScoreMessage = document.getElementById('new-high-score-message');
        const playerNameInput = document.getElementById('player-name-input');
        const legendaryMessage = document.getElementById('legendary-message');

        // Configura√ß√µes do Jogo
        const GAME_WIDTH = 600;
        const GAME_HEIGHT = 600;
        const FPS = 60;
        const FRAME_TIME = 1000 / FPS;

        let gameLoopRef;
        let gameState = {
            score: 0,
            lives: 3,
            isGameOver: false,
            isGameRunning: false,
            level: 1,
            time: 0, // Tempo em frames
        };

        // Player/Dog
        const player = {
            x: GAME_WIDTH / 2 - 25,
            y: GAME_HEIGHT / 2 - 25,
            width: 50,
            height: 50,
            baseSpeed: 5,
            currentSpeed: 5,
            isInvincible: false,
            invincibleEndTime: 0,
            speedBoostEndTime: 0,
        };

        // Inimigos, Power-ups, Proj√©teis
        let entities = [];
        let bullets = [];
        const BULLET_SPEED = 10;
        const BULLET_SIZE = 15;

        // Entradas (Teclas)
        const keys = {};

        // Imagens do Jogo (Usando os arquivos mencionados)
        const IMAGES = {};
        const IMAGE_FILES = {
            player: 'dog.png',
            enemy: 'mob.png',
            bone: 'bone.png', // Proj√©til
            powerup_speed: 'speed.png',
            powerup_life: 'life.png',
            powerup_rainbow: 'rainbow.png',
            powerup_score: 'bone.png' // Osso como power-up de score
        };
        let imagesLoaded = false;
        let loadedCount = 0;
        const totalImages = Object.keys(IMAGE_FILES).length;

        function loadGameImages() {
            return new Promise((resolve) => {
                Object.keys(IMAGE_FILES).forEach(key => {
                    IMAGES[key] = new Image();
                    IMAGES[key].onload = () => {
                        loadedCount++;
                        if (loadedCount === totalImages) {
                            imagesLoaded = true;
                            resolve();
                        }
                    };
                    IMAGES[key].onerror = () => {
                         // Fallback para caso as imagens n√£o estejam na mesma pasta
                        console.warn(`Could not load image ${IMAGE_FILES[key]}. Using fallback.`);
                        loadedCount++;
                        if (loadedCount === totalImages) {
                             imagesLoaded = true;
                            resolve();
                        }
                    };
                    // Tenta carregar as imagens (devem estar na mesma pasta do index.html)
                    IMAGES[key].src = IMAGE_FILES[key]; 
                });
            });
        }

        // --- Fun√ß√µes Auxiliares do Jogo ---

        function dist(x1, y1, x2, y2) {
            return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
        }

        function isColliding(obj1, obj2, tolerance = 0.8) {
            const center1 = { x: obj1.x + obj1.width / 2, y: obj1.y + obj1.height / 2 };
            const center2 = { x: obj2.x + obj2.width / 2, y: obj2.y + obj2.height / 2 };
            const minDistance = (obj1.width / 2) + (obj2.width / 2);

            return dist(center1.x, center1.y, center2.x, center2.y) < minDistance * tolerance;
        }
        
        function getLevel() {
            return Math.floor(gameState.score / 500) + 1;
        }
        
        function getEnemySpeed() {
             // Aumenta a velocidade do inimigo com o n√≠vel
            return 3 + (gameState.level * 0.5); 
        }
        
        function getEnemySpawnRate() {
            // Taxa de spawn, quanto menor, mais inimigos
             return Math.max(0.015, 0.03 - (gameState.level * 0.003)); 
        }

        function createEnemy() {
            let x, y;
            const size = 40;
            const side = Math.floor(Math.random() * 4); 

            if (side === 0) { x = Math.random() * GAME_WIDTH; y = -size; } // Cima
            else if (side === 1) { x = GAME_WIDTH; y = Math.random() * GAME_HEIGHT; } // Direita
            else if (side === 2) { x = Math.random() * GAME_WIDTH; y = GAME_HEIGHT; } // Baixo
            else { x = -size; y = Math.random() * GAME_HEIGHT; } // Esquerda

            const targetX = player.x + player.width / 2;
            const targetY = player.y + player.height / 2;
            const dx = targetX - (x + size / 2);
            const dy = targetY - (y + size / 2);
            const magnitude = Math.sqrt(dx * dx + dy * dy);
            
            const speed = getEnemySpeed() + (Math.random() - 0.5) * 1; // Vari√¢ncia
            
            return {
                x, y, width: size, height: size, type: 'enemy',
                speedX: (dx / magnitude) * speed,
                speedY: (dy / magnitude) * speed,
                health: 1 // Inimigos s√£o eliminados com 1 acerto
            };
        }
        
        function createPowerUp(type) {
            const size = 30;
            return {
                x: Math.random() * (GAME_WIDTH - size),
                y: Math.random() * (GAME_HEIGHT - size),
                width: size,
                height: size,
                type: type, // 'powerup_score', 'powerup_speed', 'powerup_life', 'powerup_rainbow'
            };
        }

        function createBullet() {
            const dx = keys['ArrowRight'] - keys['ArrowLeft'];
            const dy = keys['ArrowDown'] - keys['ArrowUp'];
            const directionSet = dx !== 0 || dy !== 0;

            let angle, speedX, speedY;

            if (directionSet) {
                // Se o jogador est√° se movendo, atira na dire√ß√£o de movimento
                angle = Math.atan2(dy, dx);
            } else {
                 // Se o jogador estiver parado, atira para o topo (padr√£o)
                angle = -Math.PI / 2;
            }

            speedX = Math.cos(angle) * BULLET_SPEED;
            speedY = Math.sin(angle) * BULLET_SPEED;

            return {
                x: player.x + player.width / 2 - BULLET_SIZE / 2,
                y: player.y + player.height / 2 - BULLET_SIZE / 2,
                width: BULLET_SIZE,
                height: BULLET_SIZE,
                speedX: speedX,
                speedY: speedY,
            };
        }
        
        let lastShotTime = 0;
        const FIRE_RATE = 300; // 300ms entre tiros

        function handleShooting() {
            if (keys['x'] || keys['X']) {
                const now = Date.now();
                if (now - lastShotTime > FIRE_RATE) {
                    bullets.push(createBullet());
                    lastShotTime = now;
                }
            }
        }

        function applyPowerUp(type) {
            const now = Date.now();
            switch (type) {
                case 'powerup_score':
                    gameState.score += 50; 
                    updateScoreDisplay();
                    break;
                case 'powerup_speed':
                    player.speedBoostEndTime = now + 5000; // 5 segundos
                    player.currentSpeed = player.baseSpeed * 1.5;
                    showToast('üöÄ Velocidade Aumentada!', 'info', 2000);
                    break;
                case 'powerup_life':
                    gameState.lives = Math.min(3, gameState.lives + 1); 
                    updateLivesDisplay();
                    showToast('‚ù§Ô∏è Vida Recuperada!', 'success', 2000);
                    break;
                case 'powerup_rainbow':
                    player.invincibleEndTime = now + 8000; // 8 segundos
                    player.isInvincible = true;
                    legendaryMessage.style.display = 'block';
                    setTimeout(() => {
                        legendaryMessage.style.display = 'none';
                    }, 8000);
                    showToast('‚ú® INVENCIBILIDADE ATIVA!', 'success', 2000);
                    break;
            }
        }
        
        // --- Atualiza√ß√£o do Jogo ---

        function updatePlayer() {
            const now = Date.now();
            
            // Gerencia Power-up de Velocidade
            if (now > player.speedBoostEndTime) {
                player.currentSpeed = player.baseSpeed;
            }

            // Gerencia Power-up de Invencibilidade
            if (player.isInvincible && now > player.invincibleEndTime) {
                player.isInvincible = false;
            }

            // Atualiza Posi√ß√£o do Jogador
            const speed = player.currentSpeed;
            const dx = (keys['ArrowRight'] || keys['d']) - (keys['ArrowLeft'] || keys['a']);
            const dy = (keys['ArrowDown'] || keys['s']) - (keys['ArrowUp'] || keys['w']);

            // Movimento Diagonal
            if (dx !== 0 && dy !== 0) {
                const diagonalSpeed = speed / Math.sqrt(2);
                player.x += dx * diagonalSpeed;
                player.y += dy * diagonalSpeed;
            } else {
                player.x += dx * speed;
                player.y += dy * speed;
            }

            // Limitar movimento dentro do canvas
            player.x = Math.max(0, Math.min(player.x, GAME_WIDTH - player.width));
            player.y = Math.max(0, Math.min(player.y, GAME_HEIGHT - player.height));
            
            handleShooting();
        }

        function updateBullets() {
            bullets = bullets.filter(bullet => {
                bullet.x += bullet.speedX;
                bullet.y += bullet.speedY;

                // Remove se sair da tela
                return bullet.x > -BULLET_SIZE && bullet.x < GAME_WIDTH + BULLET_SIZE &&
                       bullet.y > -BULLET_SIZE && bullet.y < GAME_HEIGHT + BULLET_SIZE;
            });
        }

        function updateEntities() {
            entities = entities.filter(entity => {
                // Move entidades
                if (entity.type === 'enemy') {
                    entity.x += entity.speedX;
                    entity.y += entity.speedY;

                    // Colis√£o Inimigo com Jogador
                    if (isColliding(player, entity, 0.7)) {
                        if (!player.isInvincible) {
                            gameState.lives--;
                            updateLivesDisplay();
                            player.isInvincible = true;
                            player.invincibleEndTime = Date.now() + 1500; // 1.5s de invencibilidade
                            if (gameState.lives <= 0) {
                                endGame();
                                return false; // Remove inimigo ap√≥s colis√£o fatal
                            }
                        }
                        return false; // Inimigo √© destru√≠do
                    }

                    // Colis√£o Inimigo com Proj√©til
                    let hitByBullet = false;
                    bullets = bullets.filter(bullet => {
                        if (isColliding(bullet, entity, 0.9)) {
                            hitByBullet = true;
                            entity.health--;
                            return false; // Remove o proj√©til
                        }
                        return true; // Mant√©m o proj√©til
                    });
                    
                    if (hitByBullet) {
                        gameState.score += 10;
                        updateScoreDisplay();
                        if (entity.health <= 0) {
                            return false; // Remove inimigo
                        }
                    }

                    // Remove inimigos que saem muito da tela
                    const boundary = 100;
                    if (entity.x < -boundary || entity.x > GAME_WIDTH + boundary ||
                        entity.y < -boundary || entity.y > GAME_HEIGHT + boundary) {
                        return false;
                    }
                    
                } else {
                    // Colis√£o Power-up com Jogador
                    if (isColliding(player, entity, 0.8)) {
                        applyPowerUp(entity.type);
                        return false; // Remove power-up coletado
                    }
                }
                return true; // Mant√©m a entidade
            });
        }

        function spawnEntities() {
            // N√≠vel do Jogo
            const newLevel = getLevel();
            if (newLevel > gameState.level) {
                 gameState.level = newLevel;
                 checkAchievement('dogLevel', gameState.level);
                 showToast(`‚¨ÜÔ∏è N√≠vel ${gameState.level}! Inimigos mais r√°pidos.`, 'warning');
            }
            
            // Spawna Inimigo
            if (Math.random() < getEnemySpawnRate()) {
                entities.push(createEnemy());
            }

            // Spawna Power-up (menos frequente)
            if (Math.random() < 0.005) { 
                const types = ['powerup_score', 'powerup_speed', 'powerup_life', 'powerup_rainbow'];
                // Chance maior para power-up de score e velocidade (50% de chance combinada)
                let randomType;
                const r = Math.random();
                if (r < 0.35) randomType = 'powerup_score'; // 35% Osso (score)
                else if (r < 0.50) randomType = 'powerup_speed'; // 15% Velocidade
                else if (r < 0.75) randomType = 'powerup_life'; // 25% Vida
                else randomType = 'powerup_rainbow'; // 25% Arco-√≠ris (invencibilidade)

                entities.push(createPowerUp(randomType));
            }
        }
        
        function updateGame() {
            if (gameState.isGameOver || !gameState.isGameRunning) return;

            updatePlayer();
            updateBullets();
            updateEntities();
            spawnEntities();
            
            gameState.time++;
        }

        // --- Renderiza√ß√£o ---
        
        function drawEntity(entity) {
            let img = IMAGES[entity.type];

            if (img && img.complete) {
                // Desenha a imagem
                gameCtx.drawImage(img, entity.x, entity.y, entity.width, entity.height);
            } else {
                // Fallback (Desenha um ret√¢ngulo)
                gameCtx.fillStyle = entity.type === 'enemy' ? 'red' : 'yellow';
                gameCtx.fillRect(entity.x, entity.y, entity.width, entity.height);
            }
        }

        function drawPlayer() {
            const playerImage = IMAGES.player;
            if (playerImage && playerImage.complete) {
                // Efeito de piscar durante a invencibilidade
                if (player.isInvincible && Math.floor(Date.now() / 150) % 2 === 0) {
                    // Desenha com opacidade reduzida ou n√£o desenha
                    gameCtx.globalAlpha = 0.5;
                }
                gameCtx.drawImage(playerImage, player.x, player.y, player.width, player.height);
                gameCtx.globalAlpha = 1.0; // Restaura a opacidade
            } else {
                gameCtx.fillStyle = player.isInvincible ? 'cyan' : 'blue';
                gameCtx.fillRect(player.x, player.y, player.width, player.height);
            }
        }
        
        function drawBullets() {
            const boneImage = IMAGES.bone;
            bullets.forEach(bullet => {
                if (boneImage && boneImage.complete) {
                    gameCtx.drawImage(boneImage, bullet.x, bullet.y, bullet.width, bullet.height);
                } else {
                    gameCtx.fillStyle = 'white';
                    gameCtx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
                }
            });
        }
        
        function drawUI() {
            // Desenha o n√≠vel
            gameCtx.fillStyle = 'rgba(255, 255, 255, 0.7)';
            gameCtx.font = "24px 'Press Start 2P', cursive";
            gameCtx.textAlign = 'right';
            const levelText = getTranslation('level_text', 'N√≠vel: ') + gameState.level;
            gameCtx.fillText(levelText, GAME_WIDTH - 10, 30);
            
            // Exibe status tempor√°rios
            const now = Date.now();
            let statusText = '';
            if (now < player.speedBoostEndTime) {
                statusText = getTranslation('status_speed', 'VELOCIDADE!');
            } else if (player.isInvincible) {
                statusText = getTranslation('status_invincible', 'INVENC√çVEL!');
            }
            
            if (statusText) {
                gameCtx.fillStyle = 'yellow';
                gameCtx.textAlign = 'center';
                gameCtx.fillText(statusText, GAME_WIDTH / 2, 30);
            }
        }

        function drawGame() {
            // Limpa o canvas
            gameCtx.clearRect(0, 0, GAME_WIDTH, GAME_HEIGHT);
            gameCtx.fillStyle = '#0d0d0d';
            gameCtx.fillRect(0, 0, GAME_WIDTH, GAME_HEIGHT);

            // Desenha entidades
            entities.forEach(drawEntity);

            // Desenha proj√©teis
            drawBullets();

            // Desenha o jogador
            drawPlayer();
            
            // Desenha UI (dentro do canvas)
            drawUI();
        }

        // --- Loop Principal ---

        function gameLoop() {
            const now = Date.now();
            
            updateGame();
            drawGame();
            
            gameLoopRef = requestAnimationFrame(gameLoop);
        }

        // --- Inicializa√ß√£o e Fim de Jogo ---

        function updateScoreDisplay() {
            const lang = localStorage.getItem('language') || 'pt-br';
            const scoreText = translations[lang]['score'].split(':')[0];
            scoreDisplay.textContent = `${scoreText}: ${gameState.score}`;
            checkAchievement('dogLevel', gameState.level); // Verifica conquistas a cada update de score
        }
        
        function updateLivesDisplay() {
            const lang = localStorage.getItem('language') || 'pt-br';
            const livesText = translations[lang]['lives'].split(':')[0];
            livesDisplay.textContent = `${livesText}: ${gameState.lives}`;
        }
        
        function updateHighScoreDisplay() {
            const highScores = getHighScores();
            const currentHighScore = highScores.length > 0 ? highScores[0].score : 0;
            const lang = localStorage.getItem('language') || 'pt-br';
            const hsText = translations[lang]['high_score'].split(':')[0];
            highScoreDisplay.textContent = `${hsText}: ${currentHighScore}`;
        }
        
        function initGame() {
            if (!imagesLoaded) {
                 showToast('Carregando imagens do jogo...', 'info', 2000);
                 return;
            }
            
            // Esconde telas
            startScreen.style.display = 'none';
            gameOverScreen.style.display = 'none';
            gameCanvas.style.display = 'block';

            // Reseta o estado
            gameState.score = 0;
            gameState.lives = 3;
            gameState.isGameOver = false;
            gameState.isGameRunning = true;
            gameState.level = 1;
            gameState.time = 0;
            
            // Reseta jogador e entidades
            player.x = GAME_WIDTH / 2 - player.width / 2;
            player.y = GAME_HEIGHT / 2 - player.height / 2;
            player.currentSpeed = player.baseSpeed;
            player.isInvincible = false;
            player.invincibleEndTime = 0;
            player.speedBoostEndTime = 0;
            entities = [];
            bullets = [];
            
            // Atualiza o display
            updateScoreDisplay();
            updateLivesDisplay();
            updateHighScoreDisplay();
            
            // Inicia o loop
            if (gameLoopRef) {
                cancelAnimationFrame(gameLoopRef);
            }
            gameLoopRef = requestAnimationFrame(gameLoop);
        }
        
        function endGame() {
            gameState.isGameRunning = false;
            gameState.isGameOver = true;
            
            cancelAnimationFrame(gameLoopRef);
            
            finalScoreDisplay.textContent = gameState.score;
            
            const highScores = getHighScores();
            const currentHighScore = highScores.length > 0 ? highScores[0].score : 0;
            
            let isNewHighScore = gameState.score > currentHighScore;
            
            newHighScoreMessage.style.display = isNewHighScore ? 'block' : 'none';
            playerNameInput.value = '';
            
            // Exibe tela de Game Over
            gameOverScreen.style.display = 'flex';
        }
        
        // --- Leaderboard ---
        
        function getHighScores() {
             return JSON.parse(localStorage.getItem('dogHighScores')) || [];
        }

        function saveHighScore(name, score) {
            const highScores = getHighScores();
            const newEntry = { name: name.toUpperCase(), score: score, date: new Date().toISOString() };
            
            highScores.push(newEntry);
            // Ordena do maior para o menor e pega os 10 primeiros
            highScores.sort((a, b) => b.score - a.score);
            const topScores = highScores.slice(0, 10); 
            
            localStorage.setItem('dogHighScores', JSON.stringify(topScores));
            
            // Atualiza o display de recorde
            updateHighScoreDisplay(); 
            // Renderiza o leaderboard
            renderLeaderboard();
        }
        
        function renderLeaderboard() {
            const leaderboardBody = document.getElementById('leaderboard-body');
            leaderboardBody.innerHTML = '';
            const highScores = getHighScores();
            const lang = localStorage.getItem('language') || 'pt-br';

            if (highScores.length === 0) {
                leaderboardBody.innerHTML = `<tr><td colspan="3" style="text-align: center;">${translations[lang].no_records}</td></tr>`;
                return;
            }
            
            highScores.forEach((entry, index) => {
                const row = leaderboardBody.insertRow();
                const rankCell = row.insertCell();
                const nameCell = row.insertCell();
                const scoreCell = row.insertCell();
                
                rankCell.textContent = `#${index + 1}`;
                nameCell.textContent = entry.name;
                scoreCell.textContent = entry.score;
            });
        }
        
        function submitHighScore() {
            let name = playerNameInput.value.trim().toUpperCase();
            if (name.length < 3) {
                name = 'AAA'; // Nome padr√£o se o usu√°rio n√£o digitar 3 letras
            }

            const highScores = getHighScores();
            const currentHighScore = highScores.length > 0 ? highScores[0].score : 0;
            
            // Verifica se a pontua√ß√£o √© realmente um novo recorde antes de salvar
            if (gameState.score > currentHighScore) {
                 saveHighScore(name, gameState.score);
                 showToast(getTranslation('notif_new_record'), 'success', 4000);
            } else if (gameState.score > (highScores[highScores.length - 1]?.score || 0) || highScores.length < 10) {
                 // Salva se for um score alto (top 10)
                 saveHighScore(name, gameState.score);
            }
            
            // Inicia um novo jogo
            initGame();
        }
        
        // --- Eventos do Jogo ---

        // Configura√ß√£o de Eventos
        document.addEventListener('keydown', (e) => { keys[e.key] = true; });
        document.addEventListener('keyup', (e) => { 
            keys[e.key] = false;
            // Impede a repeti√ß√£o de tiro ao segurar a tecla
            if (e.key === 'x' || e.key === 'X') {
                 lastShotTime = 0; 
            }
        });

        startButton.addEventListener('click', () => {
             // Esconde o modal de settings se estiver aberto
             document.getElementById('settings-modal').style.display = 'none';
             initGame();
        });

        restartButton.addEventListener('click', submitHighScore);
        
        playerNameInput.addEventListener('keydown', (e) => {
             // Permite o Enter na tela de Game Over para submeter
            if (e.key === 'Enter') {
                submitHighScore();
            }
            // Limita a 3 caracteres e apenas letras/backspace
            if (e.key.length === 1 && !/[a-zA-Z]/.test(e.key) && e.key !== 'Backspace') {
                e.preventDefault();
            }
        });
        
        // Tela Cheia
        document.getElementById('fullscreen-button').addEventListener('click', () => {
            const gameContainer = document.getElementById('dog-game-controls');
            if (gameContainer.requestFullscreen) {
                gameContainer.requestFullscreen();
            } else if (gameContainer.mozRequestFullScreen) { /* Firefox */
                gameContainer.mozRequestFullScreen();
            } else if (gameContainer.webkitRequestFullscreen) { /* Chrome, Safari and Opera */
                gameContainer.webkitRequestFullscreen();
            } else if (gameContainer.msRequestFullscreen) { /* IE/Edge */
                gameContainer.msRequestFullscreen();
            }
        });

        // ====================================================================
        // --- CONFIGURA√á√ïES DO SITE E Inicializa√ß√£o ---
        // ====================================================================

        function getTranslation(key, defaultValue = '') {
             return translations[currentLang][key] || defaultValue;
        }

        // Fun√ß√£o principal de inicializa√ß√£o
        async function fullInit() {
            // 1. Aplica o Tema e Idioma
            applyTheme(currentTheme);
            document.getElementById('language-selector').value = currentLang;
            translatePage(currentLang);
            
            // 2. Carrega Imagens do Jogo
            await loadGameImages();
            
            // 3. Carrega Conte√∫do Din√¢mico
            loadGameLinks();
            renderAchievements();
            renderNews();
            renderLeaderboard();
            updateHighScoreDisplay(); // Exibe o recorde inicial

            // 4. Marca a Conquista de Boas-vindas
            checkAchievement('welcome');
        }
        
        // --- Eventos de Configura√ß√£o ---
        
        // Modal de Configura√ß√µes
        const settingsModal = document.getElementById('settings-modal');
        const settingsBtn = document.getElementById('settings-button');
        const closeSettingsBtn = document.getElementById('close-settings-modal');

        settingsBtn.onclick = () => { settingsModal.style.display = 'block'; };
        closeSettingsBtn.onclick = () => { settingsModal.style.display = 'none'; };
        window.onclick = (event) => {
            if (event.target === settingsModal) {
                settingsModal.style.display = 'none';
            }
        };
        
        // Alternar Tema
        document.getElementById('toggle-theme').addEventListener('click', () => {
             const newTheme = document.body.classList.contains('light-mode') ? 'dark' : 'light';
             applyTheme(newTheme);
             showToast(getTranslation(newTheme === 'dark' ? 'notif_theme_dark' : 'notif_theme_light'), 'info', 2000);
        });

        // Sele√ß√£o de Idioma
        document.getElementById('language-selector').addEventListener('change', (e) => {
            const newLang = e.target.value;
            localStorage.setItem('language', newLang);
            translatePage(newLang);
        });
        
        // Resetar Conquistas
        document.getElementById('reset-achievements-btn').addEventListener('click', () => {
            if (confirm(getTranslation('config_reset_achievements') + '?')) {
                localStorage.removeItem('achievements');
                renderAchievements();
                showToast(getTranslation('notif_reset_achievements'), 'success', 3000);
            }
        });
        
        // Limpar Todos os Dados
        document.getElementById('clear-local-data-btn').addEventListener('click', () => {
            if (confirm(getTranslation('config_reset_data') + ' ' + getTranslation('config_clear_all') + '?')) {
                localStorage.clear();
                // Opcional: Recarrega a p√°gina para aplicar o reset completo
                window.location.reload(); 
                showToast(getTranslation('notif_cleared_data'), 'success', 4000);
            }
        });
        
        // Inicializa√ß√£o Completa ao carregar a p√°gina
        fullInit();
        
        // Garante que a fun√ß√£o toggleMenu esteja dispon√≠vel globalmente
        window.toggleMenu = toggleMenu; 

    </script>
</body>
</html>
